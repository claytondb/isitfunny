<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Is It Funny? - AI Humor Analyzer</title>
    <meta name="description" content="Use AI to analyze if a joke is funny. Get explanations, ratings, and suggestions to make it funnier.">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Poppins', system-ui, sans-serif;
            min-height: 100vh;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
            padding: 20px;
        }

        .container {
            max-width: 700px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            padding: 40px 0;
            color: white;
        }

        header h1 {
            font-size: 3rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 10px rgba(0,0,0,0.2);
        }

        header p {
            font-size: 1.2rem;
            opacity: 0.9;
        }

        .card {
            background: white;
            border-radius: 20px;
            padding: 35px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.2);
            margin-bottom: 25px;
        }

        textarea {
            width: 100%;
            min-height: 150px;
            padding: 20px;
            border: 2px solid #eee;
            border-radius: 12px;
            font-family: inherit;
            font-size: 1.1rem;
            resize: vertical;
            transition: border-color 0.3s;
        }

        textarea:focus {
            outline: none;
            border-color: #667eea;
        }

        .analyze-btn {
            width: 100%;
            padding: 18px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 1.2rem;
            font-weight: 600;
            cursor: pointer;
            margin-top: 20px;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .analyze-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.4);
        }

        .analyze-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .result {
            display: none;
        }

        .result.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Rating display */
        .rating-section {
            text-align: center;
            padding: 30px 0;
            border-bottom: 1px solid #eee;
            margin-bottom: 25px;
        }

        .rating-label {
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 2px;
            color: #888;
            margin-bottom: 10px;
        }

        .rating-value {
            font-size: 5rem;
            font-weight: 700;
            line-height: 1;
        }

        .rating-text {
            font-size: 1.5rem;
            font-weight: 600;
            margin-top: 10px;
        }

        .rating-1, .rating-2 { color: #e74c3c; }
        .rating-3, .rating-4 { color: #f39c12; }
        .rating-5, .rating-6 { color: #f1c40f; }
        .rating-7, .rating-8 { color: #2ecc71; }
        .rating-9, .rating-10 { color: #27ae60; }

        /* Explanation sections */
        .section {
            margin-bottom: 25px;
        }

        .section h3 {
            font-size: 1.1rem;
            color: #667eea;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .section p {
            color: #555;
            line-height: 1.7;
        }

        /* Tags */
        .tags {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 10px;
        }

        .tag {
            background: #f0f0f0;
            padding: 6px 14px;
            border-radius: 20px;
            font-size: 0.85rem;
            color: #666;
        }

        /* Improvement suggestions */
        .suggestion-box {
            background: #f8f9fa;
            border-left: 4px solid #667eea;
            padding: 15px 20px;
            border-radius: 0 10px 10px 0;
            margin-top: 10px;
        }

        /* Examples */
        .examples {
            margin-top: 20px;
        }

        .examples h4 {
            font-size: 0.9rem;
            color: #888;
            margin-bottom: 10px;
        }

        .example-btn {
            background: #f8f9fa;
            border: 1px solid #ddd;
            padding: 10px 16px;
            border-radius: 8px;
            font-size: 0.9rem;
            cursor: pointer;
            margin-right: 8px;
            margin-bottom: 8px;
            transition: all 0.2s;
        }

        .example-btn:hover {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }

        /* Loading */
        .loading {
            text-align: center;
            padding: 40px;
        }

        .spinner {
            width: 50px;
            height: 50px;
            border: 4px solid #eee;
            border-top-color: #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* API Key input */
        .api-section {
            margin-top: 15px;
        }

        .api-section summary {
            cursor: pointer;
            color: #888;
            font-size: 0.9rem;
        }

        .api-input {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
            margin-top: 10px;
            font-size: 0.9rem;
        }

        footer {
            text-align: center;
            padding: 30px;
            color: rgba(255,255,255,0.7);
            font-size: 0.9rem;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üòÇ Is It Funny?</h1>
            <p>AI-powered humor analysis</p>
        </header>

        <div class="card">
            <textarea id="joke-input" placeholder="Enter a joke, pun, story, or anything you want to analyze for humor..."></textarea>
            
            <div class="examples">
                <h4>Try an example:</h4>
                <button class="example-btn" data-joke="Why don't scientists trust atoms? Because they make up everything!">Science Pun</button>
                <button class="example-btn" data-joke="I told my wife she was drawing her eyebrows too high. She looked surprised.">Observational</button>
                <button class="example-btn" data-joke="A sandwich walks into a bar. The bartender says, 'Sorry, we don't serve food here.'">Anti-joke</button>
                <button class="example-btn" data-joke="What's the deal with airline food?">Classic Setup</button>
            </div>

            <button id="analyze-btn" class="analyze-btn">üîç Analyze Humor</button>
            
            <details class="api-section">
                <summary>Configure API (optional)</summary>
                <input type="password" id="api-key" class="api-input" placeholder="OpenAI API Key (uses demo mode if empty)">
            </details>
        </div>

        <div id="loading" class="card" style="display:none">
            <div class="loading">
                <div class="spinner"></div>
                <p>Analyzing the comedic potential...</p>
            </div>
        </div>

        <div id="result" class="card result">
            <div class="rating-section">
                <div class="rating-label">Funny Rating</div>
                <div id="rating-value" class="rating-value">7</div>
                <div id="rating-text" class="rating-text">Pretty Funny!</div>
            </div>

            <div class="section">
                <h3>üé≠ Humor Type</h3>
                <div id="humor-types" class="tags"></div>
            </div>

            <div class="section">
                <h3>üí° Explanation</h3>
                <p id="explanation"></p>
            </div>

            <div class="section">
                <h3>üìä What Works</h3>
                <p id="what-works"></p>
            </div>

            <div class="section">
                <h3>üöÄ How to Make It Funnier</h3>
                <div id="suggestions" class="suggestion-box"></div>
            </div>
        </div>
    </div>

    <footer>
        Made with üòÇ by Nero | AI-powered humor analysis
    </footer>

    <script>
        const jokeInput = document.getElementById('joke-input');
        const analyzeBtn = document.getElementById('analyze-btn');
        const loadingEl = document.getElementById('loading');
        const resultEl = document.getElementById('result');
        const apiKeyInput = document.getElementById('api-key');

        // Example buttons
        document.querySelectorAll('.example-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                jokeInput.value = btn.dataset.joke;
                jokeInput.focus();
            });
        });

        // Rating texts
        const ratingTexts = {
            1: "Not Funny üòê",
            2: "Barely a Smile üòï",
            3: "Mildly Amusing üôÇ",
            4: "Chuckle-Worthy üòè",
            5: "Decent Joke üòÑ",
            6: "Good One! üòÅ",
            7: "Pretty Funny! üòÜ",
            8: "Very Funny! üòÇ",
            9: "Hilarious! ü§£",
            10: "Comedy Gold! üíÄ"
        };

        // Demo responses for when no API key
        const demoResponses = [
            {
                rating: 7,
                types: ["Pun", "Wordplay", "Science Humor"],
                explanation: "This joke works on multiple levels. It uses the double meaning of 'make up' - both to fabricate/lie and to compose/constitute. The setup leads you to expect something about trust, then the punchline subverts expectations with a clever play on scientific terminology.",
                works: "The misdirection is well-executed. 'Make up everything' literally describes atoms (they compose all matter) while also suggesting dishonesty. The brevity keeps the punchline punchy.",
                suggestions: "Consider adding a pause before 'everything' for timing. You could extend it: 'They make up everything... including excuses for being late to chemistry class.' Adding a specific callback makes it more memorable."
            },
            {
                rating: 8,
                types: ["Observational", "Visual", "Wordplay"],
                explanation: "This joke creates a vivid mental image that sells the punchline. The humor comes from the unexpected literal interpretation of 'looking surprised' - her raised eyebrows now serve as a permanent expression of shock.",
                works: "The setup is relatable (many have seen over-drawn eyebrows). The punchline delivers a satisfying 'aha' moment. The physical comedy element makes it easy to visualize.",
                suggestions: "Timing is everything with this one. A slight pause after 'too high' lets the audience anticipate. You could add: 'I haven't told her about the lipstick yet' for a callback structure."
            },
            {
                rating: 6,
                types: ["Anti-Joke", "Absurdist", "Personification"],
                explanation: "This is a classic anti-joke format. The humor comes from subverting expectations - we expect a typical 'walks into a bar' punchline but get a logical (within the absurd premise) refusal of service instead.",
                works: "The absurdity of a sandwich having agency creates cognitive dissonance. The bartender's matter-of-fact response grounds the surrealism, making the mundane reason funnier.",
                suggestions: "Anti-jokes work best deadpan. For more punch, try: 'A sandwich walks into a bar and orders a beer. The bartender says, Sorry, we don't serve food here. The sandwich says, That's okay, I just want a drink.'"
            }
        ];

        analyzeBtn.addEventListener('click', async () => {
            const joke = jokeInput.value.trim();
            if (!joke) {
                alert('Please enter something to analyze!');
                return;
            }

            // Show loading
            analyzeBtn.disabled = true;
            loadingEl.style.display = 'block';
            resultEl.classList.remove('active');

            const apiKey = apiKeyInput.value.trim();
            
            let result;
            
            if (apiKey) {
                // Use real API
                try {
                    result = await analyzeWithAPI(joke, apiKey);
                } catch (err) {
                    alert('API Error: ' + err.message);
                    analyzeBtn.disabled = false;
                    loadingEl.style.display = 'none';
                    return;
                }
            } else {
                // Demo mode
                await new Promise(r => setTimeout(r, 1500)); // Simulate delay
                result = generateDemoResponse(joke);
            }

            // Display result
            displayResult(result);
            
            analyzeBtn.disabled = false;
            loadingEl.style.display = 'none';
        });

        async function analyzeWithAPI(joke, apiKey) {
            const response = await fetch('https://api.openai.com/v1/chat/completions', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'Authorization': `Bearer ${apiKey}`
                },
                body: JSON.stringify({
                    model: 'gpt-3.5-turbo',
                    messages: [{
                        role: 'system',
                        content: `You are a comedy expert and humor analyst. Analyze jokes and provide structured feedback. Respond in JSON format:
{
    "rating": <1-10 number>,
    "types": ["list", "of", "humor", "types"],
    "explanation": "Why this is or isn't funny",
    "works": "What elements work well",
    "suggestions": "How to make it funnier"
}`
                    }, {
                        role: 'user',
                        content: `Analyze this for humor:\n\n"${joke}"`
                    }],
                    temperature: 0.7
                })
            });

            const data = await response.json();
            if (data.error) throw new Error(data.error.message);
            
            try {
                return JSON.parse(data.choices[0].message.content);
            } catch {
                // If JSON parsing fails, extract what we can
                return {
                    rating: 5,
                    types: ["Unknown"],
                    explanation: data.choices[0].message.content,
                    works: "Analysis provided above",
                    suggestions: "See explanation"
                };
            }
        }

        function generateDemoResponse(joke) {
            // Simple heuristics + random demo
            const lower = joke.toLowerCase();
            
            // Check for common patterns
            let baseRating = 5;
            let types = [];
            
            if (lower.includes('why') && lower.includes('?')) {
                types.push('Setup-Punchline');
                baseRating += 1;
            }
            if (lower.includes("what's the deal") || lower.includes("have you ever noticed")) {
                types.push('Observational');
            }
            if (joke.split(' ').some(w => w.toLowerCase() !== w.toLowerCase().replace(/[aeiou]/gi, ''))) {
                types.push('Wordplay');
            }
            if (lower.includes('walks into a bar')) {
                types.push('Bar Joke');
            }

            if (types.length === 0) types.push('General Humor');
            
            // Add some randomness
            baseRating += Math.floor(Math.random() * 3) - 1;
            baseRating = Math.max(1, Math.min(10, baseRating));
            
            // Pick a demo response and customize
            const demo = demoResponses[Math.floor(Math.random() * demoResponses.length)];
            
            return {
                rating: baseRating,
                types: types.length > 0 ? types : demo.types,
                explanation: `This ${types[0] || 'joke'} uses a classic comedy structure. The humor depends on ${joke.length > 50 ? 'building tension through the setup before delivering the payoff' : 'quick wit and concise delivery'}. ${joke.includes('?') ? 'The question format creates anticipation.' : 'The statement format relies on surprise.'}`,
                works: demo.works,
                suggestions: demo.suggestions
            };
        }

        function displayResult(result) {
            const rating = Math.max(1, Math.min(10, Math.round(result.rating)));
            
            // Rating
            const ratingEl = document.getElementById('rating-value');
            ratingEl.textContent = rating + '/10';
            ratingEl.className = `rating-value rating-${rating}`;
            
            document.getElementById('rating-text').textContent = ratingTexts[rating];
            document.getElementById('rating-text').className = `rating-text rating-${rating}`;
            
            // Types
            document.getElementById('humor-types').innerHTML = 
                result.types.map(t => `<span class="tag">${t}</span>`).join('');
            
            // Text sections
            document.getElementById('explanation').textContent = result.explanation;
            document.getElementById('what-works').textContent = result.works;
            document.getElementById('suggestions').textContent = result.suggestions;
            
            // Show
            resultEl.classList.add('active');
            resultEl.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }
    </script>
</body>
</html>
